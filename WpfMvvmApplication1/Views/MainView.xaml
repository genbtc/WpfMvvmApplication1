<ccl:CustomChromeWindow 
    Title="Gestion des Enfants" Height="868" Width="1600" WindowStartupLocation="Manual" Background="{StaticResource ResourceKey=GenBtcColorBrush}"
        x:Class="WpfMvvmApplication1.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
        xmlns:shell="http://schemas.microsoft.com/winfx/2006/xaml/presentation/shell"
        xmlns:ccl="clr-namespace:CustomChromeLibrary;assembly=CustomChromeLibrary"        
        mc:Ignorable="d" 
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
        xmlns:scm="clr-namespace:System.ComponentModel;assembly=WindowsBase"
        xmlns:dat="clr-namespace:System.Windows.Data;assembly=PresentationFramework"
        xmlns:main="clr-namespace:WpfMvvmApplication1" 
        xmlns:models="clr-namespace:WpfMvvmApplication1.Models" 
        xmlns:viewModels="clr-namespace:WpfMvvmApplication1.ViewModels"
        xmlns:converters="clr-namespace:WpfMvvmApplication1.Converters" 
    HorizontalContentAlignment="Center" VerticalContentAlignment="Center" WindowStyle="None">

    <Window.DataContext>
        <viewModels:MainWindowViewModel x:Name="datacontextviewmodel" />
    </Window.DataContext>
    
    <ccl:CustomChromeWindow.Resources>
        <ResourceDictionary>
            <CollectionViewSource x:Key="famsorted" Source="{Binding Path=FamilyCollection}" >
                <CollectionViewSource.SortDescriptions>
                    <scm:SortDescription PropertyName="ID" />
                </CollectionViewSource.SortDescriptions>
            </CollectionViewSource>
            <CollectionViewSource x:Key="childsorted" Source="{Binding Path=ChildrenCollection}" >
                <CollectionViewSource.SortDescriptions>
                    <scm:SortDescription PropertyName="ID" />
                </CollectionViewSource.SortDescriptions>
            </CollectionViewSource>
            <models:Gender x:Key="Gender" />
            <!--<viewModels:MainWindowViewModel x:Key="MainWindowViewModel" />-->
            <converters:DebugConverter x:Key="debugConverter" />
        </ResourceDictionary>
    </ccl:CustomChromeWindow.Resources>
    
    <shell:WindowChrome.WindowChrome>
        <shell:WindowChrome
            ResizeBorderThickness="6" GlassFrameThickness="0"
            CaptionHeight="16" CornerRadius="15,15,10,10" />
    </shell:WindowChrome.WindowChrome>
                
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="1462*"/>
            <ColumnDefinition Width="116*" />
        </Grid.ColumnDefinitions>
        <!--provide the background for the entire form.  In practice, this appears as the window's resize border, because the title and window content obscure the rest-->
        <Border CornerRadius="15,15,10,10" BorderThickness="3" BorderBrush="LightSteelBlue" Grid.ColumnSpan="2" >
            <Border.Background>
                <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                    <GradientStop Color="#99bbbbff" Offset="0" />
                    <GradientStop Color="#ff7777bb" Offset="1" />
                </LinearGradientBrush>
            </Border.Background>
        </Border>

        <!--title bar-->
        <Border BorderThickness="3,3,3,1" BorderBrush="LightSteelBlue" Grid.ColumnSpan="2" >
            <Border.Background>
                <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                    <GradientStop Color="#ffbbbbff" Offset="0" />
                    <GradientStop Color="#ff7777bb" Offset="1" />
                </LinearGradientBrush>
            </Border.Background>

            <!--Window Icon and Title-->
            <TextBlock Text="Gestion des Enfants" FontFamily="Calibri" FontWeight="Bold" FontSize="16" Foreground="#FF000044" HorizontalAlignment="Center" VerticalAlignment="Top"/>
        </Border>
        <ccl:CaptionButtons Grid.ColumnSpan="2" HorizontalAlignment="Right" Margin="0,8,0,0" Width="115" />
        <!--Content-->
        <Viewbox Grid.ColumnSpan="2" Margin="0,6,0,0"> 
        <TabControl Height="837"  HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="2,0,2,0" Grid.ColumnSpan="2" Width="1605">
            <!--Children Tab-->
            <TabItem Header="Enfants">
                <Grid Height="791" VerticalAlignment="Center" >
                    <Button x:Name="savechildren" Content="Update!" Margin="1474,565,8,202" Command="{Binding Path=SaveChildren}" />
                    <StackPanel Orientation="Horizontal" Height="28" VerticalAlignment="Top" Margin="10,2,1,0">
                        <Label Content="Recherche :" />
                        <TextBox Name="Recherche" Style="{StaticResource ResourceKey=flatTextBox}" Height="23" TextWrapping="Wrap" Text="TextBox" Width="716" />
                        <Separator Height="6" Name="separator1" Width="716" Visibility="Hidden" />
                        <Button Content="+" Width="30" />
                    </StackPanel>
                        <DataGrid Name="MainDataGrid" ItemsSource="{Binding Source={StaticResource childsorted}}" AutoGenerateColumns="False" ColumnWidth="152" Margin="10,36,9,0" VerticalAlignment="Top" Height="522" 
                              BorderThickness="1,2,1,1" Background="{StaticResource ResourceKey=GenBtcColorBrush}" BorderBrush="#FF889BB1" RowBackground="Snow" HeadersVisibility="Column">
                        <DataGrid.Columns>
                            <DataGridTextColumn Binding="{Binding Path=ID}" Header="Id" Width="30" CanUserSort="True" />
                            <DataGridTextColumn Binding="{Binding Path=LASTNAME}" Header="Nom" Width="300" CanUserSort="True" />
                                <DataGridTextColumn Binding="{Binding Path=FIRSTNAME}" Header="Prénom" Width="300" CanUserSort="True" />
                                <DataGridTemplateColumn Header="Date Naissance" CanUserSort="True">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <xctk:DateTimePicker Name="dtpNaissance" Height="20" HorizontalAlignment="Left" Margin="1,0,0,0" VerticalAlignment="Top" Width="101" Format="ShortDate" 
                                                                AllowDrop="False" IsManipulationEnabled="True" ShowButtonSpinner="True" TimePickerVisibility="Hidden" Background="Snow" Value="{Binding Path=BIRTHDATE, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                                <DataGridTextColumn Binding="{Binding Path=BIRTHDATE}" Header="Age" Width="40" CanUserSort="True" />
                                <DataGridTemplateColumn Header="Gender" CanUserSort="True">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <ComboBox Name="cbGender" HorizontalAlignment="Left" Height="20" VerticalAlignment="Top" Width="111" Style="{StaticResource ResourceKey=ComboBoxFlatStyle}"
                                                    ItemsSource="{Binding Source={StaticResource Gender}, Path=ListGenders}"  DisplayMemberPath="Value" SelectedValuePath="Id" SelectedIndex="{Binding Path=GENDERID, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                                <DataGridTextColumn Binding="{Binding Path=FAMILYID, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Header="FAMILYID" Width="40" CanUserSort="True" />
                                <DataGridTemplateColumn Header="Family" Width="184" CanUserSort="True">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                            <ComboBox Name="cbFamilygrid" HorizontalAlignment="Left" VerticalAlignment="Top" Height="20" Width="181" Style="{StaticResource ResourceKey=ComboBoxFlatStyle}" 
                                                      ItemsSource="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}, Path=DataContext.FamiliesViewSource.View}" 
                                                      DisplayMemberPath="LASTNAME" SelectedValuePath="ID" IsSynchronizedWithCurrentItem="False"
                                                      SelectedIndex="{Binding Path=FAMILYID, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                    <TabControl Margin="10,574,5,6">
                        <TabItem Header="Adresse" >
                            <Grid Background="Snow" VerticalAlignment="Bottom">
                                <Label Content="Famille :" Margin="410,28,1105,127" />
                                    <ComboBox x:Name="cbFamily" Style="{StaticResource ResourceKey=ComboBoxFlatStyle}" Margin="466,28,644,127"  IsEditable="False" 
                                            ItemsSource="{Binding Source={StaticResource famsorted}}" DisplayMemberPath="LASTNAME" SelectedValuePath="ID" IsSynchronizedWithCurrentItem="False"
                                            SelectedIndex="{Binding SelectedItem.FAMILYID, ElementName=MainDataGrid}" />
                                    <TextBox x:Name="tbAdress" Style="{StaticResource ResourceKey=flatTextBox}" Margin="466,55,644,67" TextWrapping="Wrap" IsEnabled="True" Text="{Binding SelectedItem.ADRESS, ElementName=cbFamily}" />
                                    <Label Content="City :" Margin="582,115,951,36" Width="37" />
                                    <ComboBox x:Name="tbCity" Style="{StaticResource ResourceKey=ComboBoxFlatStyle}" Margin="623,116,644,39" IsEditable="False" 
                                            ItemsSource="{Binding Path=CitiesViewSource.View}" DisplayMemberPath="CITY1" SelectedValuePath="ID"
                                            SelectedIndex="{Binding SelectedItem.CITYID, ElementName=FamilyDataGrid}" 
                                            />
                                <Label Content="Adresse :" Margin="407,55,1105,99" RenderTransformOrigin="0.5,0.538" />
                                <TextBox x:Name="tbTel1" Style="{StaticResource ResourceKey=flatTextBox}" Margin="972,28,427,127" TextWrapping="Wrap" IsEnabled="True" Text="{Binding SelectedItem.TEL1, ElementName=cbFamily}" />
                                <TextBox x:Name="tbTel2" Style="{StaticResource ResourceKey=flatTextBox}" Margin="972,57,427,98" TextWrapping="Wrap" IsEnabled="True" Text="{Binding SelectedItem.TEL2, ElementName=cbFamily}" />
                                <TextBox x:Name="tbTel3" Style="{StaticResource ResourceKey=flatTextBox}" Margin="972,88,427,67" TextWrapping="Wrap" IsEnabled="True" Text="{Binding SelectedItem.TEL3, ElementName=cbFamily}" />
                                <Label Content="Tél. :" Margin="938,28,600,124" />
                            </Grid>
                        </TabItem>
                        <TabItem Header="Consignes" >
                            <Grid Background="Snow">
                                <Label Content="Médecin :" HorizontalAlignment="Left" Margin="9,10,0,0" VerticalAlignment="Top" />
                                <ComboBox x:Name="cbMedecin" Style="{StaticResource ResourceKey=ComboBoxFlatStyle}" HorizontalAlignment="Left" Margin="76,10,0,0" VerticalAlignment="Top" Width="283" Height="23" IsEditable="True" />
                                <Label Content="Tél. :" HorizontalAlignment="Left" Margin="382,10,0,0" VerticalAlignment="Top" />
                                <TextBox x:Name="tbTel" Style="{StaticResource ResourceKey=flatTextBox}" HorizontalAlignment="Left" Height="23" Margin="421,10,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="130" />
                                <Label Content="Allergies :" HorizontalAlignment="Left" Margin="10,41,0,0" VerticalAlignment="Top" />
                                <TextBox x:Name="tbAllergies" Style="{StaticResource ResourceKey=flatTextBox}" HorizontalAlignment="Left" Height="60" Margin="76,41,0,0" TextWrapping="Wrap" Text="" VerticalAlignment="Top" Width="475" />
                                <CheckBox x:Name="chkHospital" Content="Hôpital" Margin="582,15,877,143" IsChecked="{Binding SelectedItem.HOSPITAL, ElementName=MainDataGrid}" Width="78" />
                                <CheckBox x:Name="chkEMT" Content="S.A.M.U" Margin="582,40,877,120" IsChecked="{Binding SelectedItem.EMT, ElementName=MainDataGrid}" Width="78" />
                                <CheckBox x:Name="chkClinic" Content="Clinique" Margin="582,65,877,95" IsChecked="{Binding SelectedItem.CLINIC, ElementName=MainDataGrid}" Width="78" />
                                <CheckBox Content="Être Photographié" Margin="582,90,829,68" IsChecked="{Binding SelectedItem.BEPHOTOGRAPHY, ElementName=MainDataGrid}" Width="126" />
                                <CheckBox Content="Publication de l'image" Margin="582,115,809,41" IsChecked="{Binding SelectedItem.PUBLICATIONPHOTOGRAPHY, ElementName=MainDataGrid}" Width="146" />
                                <CheckBox Content="Sorties Hors Structure" Margin="848,90,550,67" IsChecked="{Binding SelectedItem.OFFOUTPUTSSTRUCTURE, ElementName=MainDataGrid}" Width="139" />
                                <CheckBox Content="Baignade" Margin="848,15,614,142" IsChecked="{Binding SelectedItem.SWIM, ElementName=MainDataGrid}" Width="75" />
                                <CheckBox Content="Sorties Vélo" Margin="848,40,600,119" IsChecked="{Binding SelectedItem.BIKEOUTINGS, ElementName=MainDataGrid}" Width="89" />
                                <CheckBox Content="Sorties Bâteau" Margin="848,65,590,93" IsChecked="{Binding SelectedItem.BOATOUTINGS, ElementName=MainDataGrid}" Width="99" />
                            </Grid>
                        </TabItem>
                        <TabItem Header="Droits" >
                            <Grid Background="Snow" />
                        </TabItem>
                        <TabItem Header="Autorisations" >
                            <Grid Background="Snow">
                                <StackPanel Height="101" HorizontalAlignment="Left" Margin="15,14,0,0" Name="stackPanelAutorisations1" VerticalAlignment="Top" Width="217">
                                    <ComboBox Style="{StaticResource ResourceKey=ComboBoxFlatStyle}" Width="149" />
                                </StackPanel>
                                <StackPanel Height="99" HorizontalAlignment="Left" Margin="707,16,0,0" Name="stackPanelAutorisations2" VerticalAlignment="Top" Width="151" />
                                <StackPanel HorizontalAlignment="Left" Margin="350,16,0,0" Name="stackPanelAutorisations3" Width="151" Height="99" VerticalAlignment="Top" />
                            </Grid>
                        </TabItem>
                        <TabItem Header="Régimes" >
                            <Grid Background="Snow">
                                <CheckBox Content="Sans Gluten" Margin="34,10,1401,151" />
                                <CheckBox Content="Sans Oeuf" Margin="167,10,1280,151" />
                                <CheckBox Content="Sans Poisson" Margin="290,10,1142,151" />
                                <CheckBox Content="Sans Porc" Margin="445,10,999,151" />
                                <CheckBox Content="Sans Viande" Margin="600,10,830,151" />
                                <Label Content="Régime Particuliers :" Margin="34,54,1386,99" />
                                <TextBox Style="{StaticResource ResourceKey=flatTextBox}" Margin="156,54,569,65" TextWrapping="Wrap" Text="" />
                            </Grid>
                        </TabItem>
                    </TabControl>
                </Grid>
            </TabItem>
            <!--Family Tab-->
            <TabItem Header="Famille">
                <Grid VerticalAlignment="Bottom" Height="798" Width="1600">
                    <StackPanel Orientation="Horizontal" Height="28" VerticalAlignment="Top" Margin="10,2,0,0" HorizontalAlignment="Left" Width="1555">
                        <Label Content="Recherche :" />
                        <TextBox Name="RechercheFamille" Style="{StaticResource ResourceKey=flatTextBox}" Height="23" TextWrapping="Wrap" Text="TextBox" Width="716" />
                        <Separator Height="6" Name="separator2" Width="626" Visibility="Hidden" />
                    </StackPanel>
                    <DataGrid Name="FamilyDataGrid" HorizontalAlignment="Left" VerticalAlignment="Top" Height="468" Width="1579" Margin="10,36,0,0" AutoGenerateColumns="False" BorderThickness="1,2,1,1" 
                              Background="{StaticResource ResourceKey=GenBtcColorBrush}" BorderBrush="#FF889BB1" RowBackground="Snow" 
                              ItemsSource="{Binding Source={StaticResource famsorted}}" HeadersVisibility="Column">
                        <DataGrid.Columns>
                                <DataGridTextColumn Binding="{Binding Path=ID}" Header="Id" Width="30" CanUserSort="True"/>
                                <DataGridTextColumn Binding="{Binding Path=LASTNAME, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Header="Nom" Width="200" CanUserSort="True" />
                                <DataGridTextColumn Binding="{Binding Path=FIRSTNAME, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Header="Prénom" Width="200" CanUserSort="True" />
                                <DataGridTextColumn Binding="{Binding Path=ADRESS, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Header="Adress" Width="200" CanUserSort="True" />
                                <DataGridTextColumn Binding="{Binding Path=CITYID, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Header="CityID" Width="200" CanUserSort="True" />
                                <DataGridTextColumn Binding="{Binding Path=TEL1, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Header="Tel1" Width="200" CanUserSort="True" />
                                <DataGridTextColumn Binding="{Binding Path=TEL2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Header="Tel2" Width="200" CanUserSort="True" />
                                <DataGridTextColumn Binding="{Binding Path=TEL3, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Header="Tel3" Width="200" CanUserSort="True" />
                        </DataGrid.Columns>
                    </DataGrid>
                    <TabControl Margin="10,520,10,18">
                        <TabItem Header="Famille">
                            <Grid HorizontalAlignment="Left" Width="1537">
                                <ComboBox Style="{StaticResource ResourceKey=ComboBoxFlatStyle}" HorizontalAlignment="Left" Margin="91,39,0,0" VerticalAlignment="Top" Width="85" />
                                <Label Content="Civilité :" HorizontalAlignment="Left" Margin="35,39,0,0" VerticalAlignment="Top" />
                                <Label Content="Nom :" HorizontalAlignment="Left" Margin="44,80,0,0" VerticalAlignment="Top" />
                                <TextBox Style="{StaticResource ResourceKey=flatTextBox}" HorizontalAlignment="Left" Height="26" Margin="91,80,0,0" TextWrapping="Wrap" Text="TextBox" VerticalAlignment="Top" Width="175" />
                            </Grid>
                        </TabItem>
                        <TabItem Header="Droits">
                            <Grid></Grid>
                        </TabItem>
                        <TabItem Header="Conjoint">
                            <Grid></Grid>
                        </TabItem>
                        <TabItem Header="Payeur">
                            <Grid></Grid>
                        </TabItem>
                    </TabControl>
                    <Button Content="Update!" Margin="1474,511,11,264" Name="savefamily" Command="{Binding Path=SaveFamily}" />
                </Grid>
            </TabItem>
        </TabControl>
        </Viewbox>            
    </Grid>
</ccl:CustomChromeWindow>
